# 🧹 お掃除記録簿

掃除習慣を楽しく継続するための記録ダッシュボードです。
ローカル保存とGoogleスプレッドシート連携の両方に対応しています。

## 📋 ファイル構成

| ファイル名 | 説明 |
|-----------|------|
| `cleaning-tracker.html` | お掃除記録ダッシュボード（メインUI） |
| `google_apps_script.gs` | Google スプレッドシート連携用スクリプト |
| `README.md` | このドキュメント |

## 🚀 セットアップ手順

### 1. HTMLダッシュボードの使用（ローカル保存のみ）

1. `cleaning-tracker.html` をダウンロード
2. ブラウザで開く
3. 掃除を記録し、データはブラウザのLocalStorageに自動保存されます

**データはブラウザのLocalStorageに保存されます**

### 2. Googleスプレッドシート連携の設定

#### Step 1: スプレッドシートの作成

1. [Google Drive](https://drive.google.com) を開く
2. 「新規」→「Google スプレッドシート」→「空白のスプレッドシート」
3. スプレッドシートに名前を付ける：**「お掃除記録簿」**
4. URLからスプレッドシートIDをコピー
   ```
   URL: https://docs.google.com/spreadsheets/d/【この部分がID】/edit
   ```

#### Step 2: Google Apps Scriptの設定

1. スプレッドシートで「拡張機能」→「Apps Script」を開く
2. デフォルトのコードを削除
3. `google_apps_script.gs` の内容をコピー＆ペースト
4. `SPREADSHEET_ID` を実際のIDに置き換え：
   ```javascript
   const SPREADSHEET_ID = 'あなたのスプレッドシートID';
   ```
5. 「保存」アイコン（💾）をクリック

#### Step 3: 初期化

1. 関数セレクタで `testInit` を選択
2. 「実行」ボタン（▶）をクリック
3. 初回実行時は認証を求められるので許可
4. スプレッドシートに以下のシートが自動作成される：
   - 「掃除記録」
   - 「設定」
   - 「コツ」
   - 「更新ログ」

#### Step 4: ウェブアプリとしてデプロイ

1. 「デプロイ」→「新しいデプロイ」
2. 歯車アイコン →「ウェブアプリ」を選択
3. 設定：
   - **説明**: お掃除記録API
   - **次のユーザーとして実行**: 自分
   - **アクセスできるユーザー**: 全員（CORSの関係で必要）
4. 「デプロイ」をクリック
5. 表示されるURLをコピー
   ```
   https://script.google.com/macros/s/XXXXXXXXXXXXXXXXXXXXXXXXXXXXXX/exec
   ```

#### Step 5: HTMLファイルにURLを設定

1. `cleaning-tracker.html` をテキストエディタで開く
2. ファイル冒頭付近にある以下の行を探す：
   ```javascript
   const API_URL = ''; // ← ここにGoogle Apps ScriptのデプロイURLを設定
   ```
3. コピーしたURLを設定：
   ```javascript
   const API_URL = 'https://script.google.com/macros/s/XXXXXX/exec';
   ```
4. ファイルを保存

これで設定完了です！ページを開くと自動的にスプレッドシートからデータが読み込まれ、記録を追加・編集・削除すると自動的にスプレッドシートに同期されます。

## 📊 Googleスプレッドシートの構成

### メインシート: 「掃除記録」

| フィールド名 | 型 | 説明 |
|-------------|-----|------|
| ID | 数値 | レコード識別子（タイムスタンプベース） |
| 日付 | 文字列 | 掃除した日付（YYYY-MM-DD形式） |
| 場所 | 文字列 | 掃除した場所（カンマ区切り） |
| 満足度 | 数値 | 1〜5の評価 |
| 時間（分） | 数値 | 掃除にかかった時間 |
| メモ | 文字列 | 気づきやコメント（500字以内） |
| 更新日時 | 日時 | 最終更新日時 |

### 設定シート: 「設定」

| フィールド名 | 型 | 説明 |
|-------------|-----|------|
| 項目 | 文字列 | 設定項目名 |
| 値 | 数値/文字列 | 設定値 |

### コツシート: 「コツ」

| フィールド名 | 型 | 説明 |
|-------------|-----|------|
| ID | 数値 | コツの識別子 |
| アイコン | 文字列 | 表示アイコン |
| タイトル | 文字列 | コツのタイトル（30字以内） |
| 説明 | 文字列 | コツの説明（50字以内） |

### ログシート: 「更新ログ」

| フィールド名 | 型 | 説明 |
|-------------|-----|------|
| タイムスタンプ | 日時 | 操作日時（日本時間） |
| 操作 | 文字列 | 保存/読込/追加/更新/削除 |
| ユーザー | 文字列 | 実行ユーザーのメールアドレス |
| 詳細 | 文字列 | 操作の詳細 |

## 🎯 ダッシュボード機能一覧

### 📈 進捗表示

- **今週の掃除状況**: 曜日ごとの達成状況をビジュアル表示
- **週間目標**: 目標達成率をプログレスバーで表示
- **統計**: 連続日数、最高記録、今月/総合の記録数と時間
- **週別グラフ**: 掃除回数の推移をグラフで可視化

### 📝 記録機能

- **場所選択**: 複数の掃除場所をタグで選択
- **満足度**: 5段階の星評価
- **時間記録**: 15分〜3時間まで選択可能
- **メモ**: 500文字以内で気づきを記録

### 💡 コツ管理

- **カスタムコツ**: 自分だけの掃除のコツを最大5件登録
- **アイコン選択**: 10種類のアイコンから選択可能
- **編集・削除**: 登録したコツの編集と削除

### 💾 データ管理

- **自動同期**: 記録の追加・編集・削除時に自動でスプレッドシートに同期
- **自動読込**: ページ表示時に自動でスプレッドシートからデータ読込
- **ローカル保存**: ブラウザのLocalStorageにもバックアップ保存
- **JSONエクスポート**: バックアップ用にJSONファイルでダウンロード
- **JSONインポート**: バックアップファイルから復元

## ⚠️ 注意事項

- **CORS制限**: スプレッドシート連携はウェブアプリのアクセス権限を「全員」に設定する必要があります
- **ブラウザ互換性**: 最新のChrome、Firefox、Edge、Safariで動作確認済み
- **データバックアップ**: 重要なデータは定期的にJSONエクスポートすることを推奨
- **複数デバイス**: スプレッドシート連携を設定すれば、PC・スマホで同じデータを共有可能

## 🔧 トラブルシューティング

### APIエラーが発生する場合

1. HTMLファイル内の`API_URL`が正しく設定されているか確認
2. Apps Scriptのデプロイ設定で「アクセスできるユーザー」が「全員」になっているか確認
3. スプレッドシートIDが正しく設定されているか確認

### データが同期されない場合

1. ブラウザの開発者ツール（F12）でコンソールエラーを確認
2. ブラウザのキャッシュをクリア
3. Apps Scriptを再デプロイ（「デプロイを管理」→「新しいデプロイ」）

## 📱 モバイル対応

このダッシュボードはレスポンシブデザインに対応しており、スマートフォンやタブレットでも快適に使用できます。

---

**🌟 掃除は自分の心を磨くこと。きれいな部屋は、きれいな心を育てます✨**
